import com.diffplug.spotless.LineEnding

buildscript {
    repositories {
        mavenCentral()
        maven {
            url 'https://plugins.gradle.org/m2/'
        }
    }

    dependencies {
        classpath 'com.diffplug.spotless:spotless-plugin-gradle:3.27.1'
    }
}

plugins {
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'checkstyle'
    apply plugin: 'com.diffplug.gradle.spotless'

    ext['log4j2.version'] = '2.17.0'

    ext {
        springBootVersion = '2.0.4.RELEASE'
        springFrameworkVersion = '5.0.7.RELEASE'
    }

    repositories {
        mavenCentral()
    }

    dependencies {
        implementation deps.spring.context
        implementation 'org.springframework.boot:spring-boot-starter-security:2.0.4.RELEASE'
        implementation 'org.springframework.security:spring-security-web:5.0.7.RELEASE'
        implementation 'io.jsonwebtoken:jjwt:0.2'
        implementation 'net.sf.ehcache:ehcache-core:2.6.11'
        implementation 'org.springframework.security:spring-security-acl:5.0.8.RELEASE'
        implementation 'org.springframework:spring-context-support:5.0.9.RELEASE'
        implementation 'javax.mail:mail:1.5.0-b01'

        implementation 'com.auth0:java-jwt:3.4.0'
        implementation 'com.auth0:auth0-spring-security-api:1.2.6'

        implementation 'org.slf4j:slf4j-api:1.7.25'

        implementation 'javax.xml.bind:jaxb-api:2.3.0'
        implementation 'javax.validation:validation-api:2.0.1.Final'
        implementation 'org.springframework.boot:spring-boot-starter-websocket:2.3.5.RELEASE'
        implementation 'org.webjars:stomp-websocket:2.3.3-1'
        implementation 'org.springframework:spring-messaging'
        implementation 'org.springframework.security:spring-security-messaging:5.0.4.RELEASE'


        implementation 'org.webjars:sockjs-client:1.1.2'


        implementation 'com.google.code.gson:gson:2.8.5'
        implementation 'org.springframework.boot:spring-boot-starter-actuator:2.3.9.RELEASE'
        testImplementation "org.springframework.boot:spring-boot-starter-test:${springBootVersion}"

        // lombok
        annotationProcessor deps.lombok
        compileOnly deps.lombok
        testAnnotationProcessor deps.lombok
    }

    test {
        //useJUnitPlatform()
    }

    checkstyle {
        toolVersion '8.29'
    }

    spotless {
        format 'misc', {
            target '**/*.gradle', '**/.*.md', '**/.gitignore'

            trimTrailingWhitespace()
            indentWithSpaces()
            endWithNewline()
            setLineEndings("UNIX" as LineEnding)
        }
        java {
            trimTrailingWhitespace()
            indentWithSpaces()
            endWithNewline()
            setLineEndings("UNIX" as LineEnding)
        }
    }
}

/* tasks.register('testReport', TestReport) {
    // destinationDir = file("$buildDir/reports/allTests")
    // reportOn subprojects*.test
} */
